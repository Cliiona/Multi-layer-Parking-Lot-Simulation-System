#include "manage.h"

int input(BUTTON *button,char *s)
{
    
    fill_Rectangle(170,47,228,58,7);
    int k;
    int m;
    int i=0;
    while(1)
    {
        m=0;
        k=bioskey(0);
		if(k==ESC) break;
        switch(k)
        {
            case ENTER: if(i==0) continue;  //若还没有输入任何东西，继续输入
                        else {m=1;break;}  //退出switch  m置1
            case BACKSPACE: if(i>0)       //退格
                            {
                                s[--i]='\0';
                                fill_Rectangle(170,47,228,58,7);
								Blit_String(17*(button->x1),button->y1-13,0,s,1);
                                continue;
                            }
            default: s[i]=k;
                     s[i+1]='\0';
					 Blit_String(17*(button->x1),button->y1-13,0,s,1);
                     i++;
        }
        if(m)  break;   //退出while
    }
     
    return m;

}


void readfile()
{
	clrscr();
	FILE *fp;
	char *s;
    char ch;
	if((fp=fopen("c:\\tc30\\bin\\_testgarage\\myfile.txt","r+"))==NULL)
	{
	 printf("can't\n");
	}


	while((ch=getchar())!='\n')
		fputc(ch,fp);
	fclose(fp);           //very important
	fp=fopen("c:\\tc30\\bin\\_testgarage\\myfile.txt","rt+");

	while(!feof(fp))
		{
			s=fgets(fp);
			Blit_String(350,60,0,s,1);
		}
	fclose(fp);
	getch();

}
