#include "jiemian.h"

/******被主函数调用的start*******/
void jiemianstart() // 主函数只调用这个子函数//
{
	jiemian_homepage();
    getch();
    exit(1);
}


/* ********成员信息********* */
void jiemian_introduction(void)
{
    Set_Video_Mode(VGA256);
    PCX_Load_Screen("intro.pcx",1);//背景
    getch();
}


/* ********主页********* */
void jiemian_homepage()
{   
    BUTTON a[4];
    BUTTON button_process={0,20,350,190,"进入模拟"};
    BUTTON button_manage={220,0,640,160,"车位管理"};
    BUTTON button_help={300,160,630,190,"使用说明"};
    BUTTON button_exit={0,0,220,20,"退出"};

    a[0]=button_process;
    a[1]=button_manage;
    a[2]=button_help;
    a[3]=button_exit;

    Set_Video_Mode(VGA256);
	mou curmouse,oldmouse; //定义鼠标结构pointer
	sprite small;

	mouse_all(&curmouse,&oldmouse,&small); //初始化鼠标结构  显示鼠标
	back("homepage.pcx",&small);
	while(kbhit()==0)
	{
		move_mouse(&curmouse,&oldmouse,&small); //移动过程中显示鼠标

		if(curmouse.key)
		{

	     if(mouse_on(a))
		   {
				//jiemian_process();
				//curmouse->key=0;
		   }
		   else if(mouse_on(a+1))
		   {
			   jiemian_manage();
               curmouse.key=0;
		   }
		   else if(mouse_on(a+2))
		   {
			    Set_Video_Mode(TEXT_MODE);
				//jiemian_instructions(); //说明界面 给我做出来！！！！！
				curmouse.key=0;
		   }
		   else if(mouse_on(a+3))
		   {
			 	exit(1);
            }
		}

	}
}


/* *******模拟泊车***** */
void jiemian_process(void)
{
  int b;
}


/* ********车位管理界面****** */
void jiemian_manage()
{
    mou oldmouse,curmouse;
    sprite small;
    Set_Video_Mode(VGA256);
    mouse_all(&curmouse,&oldmouse,&small); //初始化鼠标结构  显示鼠标
    back("manage.pcx",&small);
    BUTTON m[3];
    BUTTON button_current={400,0,550,145,"车位使用现况"};
    BUTTON button_history={220,0,350,145,"车位使用历史"};
    BUTTON button_back={620,180,639,195,"返回"};

    m[0]=button_current;
    m[1]=button_history;
    m[2]=button_back;

    while(kbhit()==0)
    {   
         move_mouse(&curmouse,&oldmouse,&small); //移动过程中显示鼠标
		 if(curmouse.key)
        {
           if(mouse_on(m))
           {
               //Sprite_Delete_Size((sprite_ptr)&small,1);
               jiemian_manage_current();
			   curmouse.key=0;
           }
           else if(mouse_on(m+1))
           {
                jiemian_manage_history();
                curmouse.key=0;
                //delay(100);
           }
           else if(mouse_on(m+2))
           { 
                jiemian_homepage();
                curmouse.key=0;
                //delay(100);
           } 
            
        }  
    }
    
}


/* **********车位使用历史********** */
void jiemian_manage_history()
{
    mou oldmouse,curmouse;
    sprite small;
    char s[20];
    int m,flag=0;
    Set_Video_Mode(VGA256);
    mouse_all(&curmouse,&oldmouse,&small); //初始化鼠标结构  显示鼠标
	back("manage2.pcx",&small);
       
    BUTTON h[4];
    BUTTON button_current={510,40,630,55,"车位使用现况"};
    BUTTON button_back={550,170,640,185,"返回主页"};
    BUTTON button_input={330,45,460,60,"输入框"};
    BUTTON button_file={0,0,300,70,"文件"};

    h[0]=button_current;
    h[1]=button_back;
    h[2]=button_input;
    h[3]=button_file;
   
    while(!kbhit())
    {   
        move_mouse(&curmouse,&oldmouse,&small); //移动过程中显示鼠标
		
        if(curmouse.key)
        {
          if(mouse_on(h))
           {
                jiemian_manage_current();
				curmouse.key=0;
           }
           else if(mouse_on(h+1))
		   {
                jiemian_homepage();   
                curmouse.key=0;
		   }
           else if(mouse_on(h+2))
           {
                Erase_Sprite_Size(&small,20,20);
			    m=input(&button_input,s);
                
                curmouse.key=0;
           }
            else if(mouse_on(h+3) && flag ==0)
            {                
                readfile(m);
                //move_mouse(&curmouse,&oldmouse,&small);
                flag=1;
                curmouse.key=0;
            }
       }
    }
}


/* **********车位使用现况********** */
void jiemian_manage_current()
{   
    mou oldmouse,curmouse;
    sprite small;
    Set_Video_Mode(VGA256);
    mouse_all(&curmouse,&oldmouse,&small); //初始化鼠标结构  显示鼠标
    back("current.pcx",&small);
       
    BUTTON c[2];
    BUTTON button_history={500,66,630,80,"车位使用历史"};
    BUTTON button_back={550,170,630,190,"返回主页"};

    c[0]=button_history;
    c[1]=button_back;

    while(!kbhit())
    {   
        move_mouse(&curmouse,&oldmouse,&small); //移动过程中显示鼠标
        if(curmouse.key )
        {
          if(mouse_on(c))
           {
                //Set_Video_Mode(TEXT_MODE);
                jiemian_manage_history();
                curmouse.key=0;
           }
           else if(mouse_on(c+1))
           {
               // Set_Video_Mode(TEXT_MODE);
                jiemian_homepage();   
                curmouse.key=0; 
           }
        }
    }
}

 


/* *******开始动画******* */
/*
void begin()
{  	
    BUTTON button_start={200,177,430,198,"start"};
    mou oldmouse,curmouse;
	oldmouse.x=0;oldmouse.y=0;oldmouse.key=0;
	curmouse.x=0;curmouse.y=0;curmouse.key=0;

	sprite c1,small;
	pcx_picture background_pcx,o1,objects_pcx;
	Set_Video_Mode(VGA256);
	PCX_Load1("C1.pcx",(pcx_picture_ptr)&o1,1);//调用图片文件
	Sprite_Init_Size((sprite_ptr)&c1,120,-5,0,0,0,0,65,55,1);//初始化小图片
	PCX_Grab_Bitmap_Size_Screen((pcx_picture_ptr)&o1,(sprite_ptr)&c1,0,0,0,65,55);//将屏幕内容复制给小图片
    
    PCX_Load1("mouse.pcx",(pcx_picture_ptr)&objects_pcx,1);//调用图片文件
	Sprite_Init_Size((sprite_ptr)&small,0,0,0,0,0,0,65,55,1);//初始化小图片
	PCX_Grab_Bitmap_Size_Screen((pcx_picture_ptr)&objects_pcx,(sprite_ptr)&small,0,0,0,65,55);//将屏幕内容复制给小图片
    
    
	Fill_Screen(0);
	PCX_Load1("sur.pcx",(pcx_picture_ptr)&background_pcx,1);//背景
	Behind_Sprite_Size((sprite_ptr)&small,65,55);
    Behind_Sprite_Size((sprite_ptr)&c1,65,55);//取图片后内容
    mousecheck();//初始化鼠标
	mousemove();//设置鼠标范围
    small.x=curmouse.x/2;
	small.y=curmouse.y;
	Behind_Sprite_Size((sprite_ptr)&small,65,55);//保存小图片后背景内容
	Draw_Sprite_Size((sprite_ptr)&small,65,55);//显示小图片于鼠标位置
		while(!kbhit())
         { 
			if(curmouse.key && mouse_on(&button_start))
             { 
                     
                  while(1)
                {
		   Erase_Sprite_Size((sprite_ptr)&c1,65,55);
		   if(c1.y<140)c1.y++;
		   Behind_Sprite_Size((sprite_ptr)&c1,65,55);
		   Draw_Sprite_Size((sprite_ptr)&c1,65,55);
			   if(c1.y==138)
                        {
                              
                              while(c1.x<210)
            
                               {   
				  Erase_Sprite_Size((sprite_ptr)&c1,65,55);
                                  c1.x++;
		                  Behind_Sprite_Size((sprite_ptr)&c1,65,55);
				  Draw_Sprite_Size((sprite_ptr)&c1,65,55);
								  delay(10);
                
                               }
                             delay(20);
                             while(c1.x>53)
                              {
              	                  Erase_Sprite_Size((sprite_ptr)&c1,65,55);
                                  c1.x--;
		                  Behind_Sprite_Size((sprite_ptr)&c1,65,55);
				  Draw_Sprite_Size((sprite_ptr)&c1,65,55);
                                  delay(10);
                             }
                             Sprite_Delete_Size((sprite_ptr)&c1,1);
                             break;
                        }
					  delay(9);
               }
              PCX_Load_Screen("op.pcx",1);///////////////切换到下一个界面            
              break;
                
           }
       
        else 
       {   
            mouseread(&curmouse);
    	    if(curmouse.x!=oldmouse.x||curmouse.y!=oldmouse.y)//判断是否移动过鼠标
	      {
		    Erase_Sprite_Size((sprite_ptr)&small,65,55);//显示小图片后背景内容
                    small.x=curmouse.x/2;
	            small.y=curmouse.y;
		    Behind_Sprite_Size((sprite_ptr)&small,65,55);//保存小图片后背景内容
	    	    Draw_Sprite_Size((sprite_ptr)&small,65,55);//显示小图片于鼠标位置
	    	    oldmouse.x=curmouse.x;
		    oldmouse.y=curmouse.y;
    	 }
      }
 
    }  
      getch();
          
}	*/
